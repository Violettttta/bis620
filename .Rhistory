reticulate::repl_python()
library(reticulate)
use_condaenv("bis620", required = TRUE)
library(reticulate)
use_condaenv("bis620", required = TRUE)
reticulate::repl_python()
x4 <- sparseMatrix(
i = c(1, 1, 3, 6),
j = c(2, 3, 5, 1),
x = c(4.3, 5.6, 7, 10),
dims = c(6, 6) # specify the dimension
)
library(Matrix)
x4 <- sparseMatrix(
i = c(1, 1, 3, 6),
j = c(2, 3, 5, 1),
x = c(4.3, 5.6, 7, 10),
dims = c(6, 6) # specify the dimension
)
x3 <- Matrix(rnorm(36), ncol = 6)
View(x3)
View(x4)
x1 <- bis620_sparse_matrix(
i = c(1, 2, 5, 6),
j = c(2, 2, 6, 1),
x = c(4.3, 5.6, 7, 10)
)
(2.409+1.282)^2
(2.409+1.282)^2*6.7^2
(2.409+1.282)^2*6.7^2/9
1088-67.9509
1088^2/1020.049
1161/0.75
544/(1548-1088)
4*(2.409+1.282)^2*6.7^2/1.5^2
544^2/(544-67.9509)
621.6502-544
544/78
6312/86
540/78
5*0.15/sqrt(0.375*0.625)
1.549193-1.96
bis620_sparse_add <- function(a, b) {
browser()
cc <- merge(a, b, by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
cc$x[is.na(cc$x)] <- 0
cc$x2[is.na(cc$x2)] <- 0
cc$x <- cc$x + cc$x2
cc[, c("i", "j", "x")]
}
# row 1 column 1, value is 4.4;
# row 2 column 1, value is 1.2
# the dimension is maximum or can be specified
bsm1 <- data.frame(i = c(1, 2), j = c(1, 1), x = c(4.4, 1.2))
bsm2 <- data.frame(i = c(3, 1), j = c(1, 3), x = c(4.4, 1.2))
bis620_sparse_add(bsm1, bsm2)
setClass(Class = "bis620_sparse_matrix",
slots = list(i = i, j = j, x = x))
setClass(Class = "bis620_sparse_matrix",
slots = list(i = "numeric",
j = "numeric",
x = "numeric"))
setClass(Class = "bis620_sparse_matrix",
slots = list(i = "numeric",
j = "numeric",
x = "numeric"))
my_matrix <- new("bis620_sparse_matrix", i = c(1, 2), j = c(1, 1), x = c(4.4, 1.2))
my_matrix
class(my_matrix)
matrix(rnorm(36), ncol = 6)
knitr::opts_chunk$set(echo = TRUE)
setClass(Class = "bis620_sparse_matrix",
slots = list(i = "numeric",
j = "numeric",
x = "numeric"))
x1 <- new("bis620_sparse_matrix",
i = c(1, 2, 5, 6),
j = c(2, 2, 6, 1),
x = c(4.3, 5.6, 7, 10)
)
setGeneric(
"plus",
function(a, b){
standardGeneric("plus")
}
)
setMethod(
f = "`+`",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(a, b, by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c[, c("i", "j", "x")]
}
)
setGeneric(
"`+`",
function(a, b){
standardGeneric("`+`")
}
)
setMethod(
f = "`+`",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(a, b, by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c[, c("i", "j", "x")]
}
)
`+`(x1, x1)
class(x1)
x1
setGeneric(
"plus",
function(a, b){
standardGeneric("plus")
}
)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(a, b, by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c[, c("i", "j", "x")]
}
)
plus(x1, x1)
library(Matrix)
x4 <- sparseMatrix(
i = c(1, 1, 3, 6),
j = c(2, 3, 5, 1),
x = c(4.3, 5.6, 7, 10),
dims = c(6, 6)
)
x4
x1
setClass(Class = "bis620_sparse_matrix",
slots = c(i = "numeric",
j = "numeric",
x = "numeric"))
x1 <- new("bis620_sparse_matrix",
i = c(1, 2, 5, 6),
j = c(2, 2, 6, 1),
x = c(4.3, 5.6, 7, 10)
)
x1
x1 <- new("bis620_sparse_matrix",
i = c(1, "1", 5, 6),
j = c(2, 2, 6, 1),
x = c(4.3, 5.6, 7, 10)
)
setGeneric(
"plus",
function(a, b){
standardGeneric("plus")
}
)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(a, b, by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c[, c("i", "j", "x")]
}
)
plus(x1, x1)
x4
x1
bis620_sparse_matrix
setClass(Class = "bis620_sparse_matrix",
slots = data.frame(i = "numeric",
j = "numeric",
x = "numeric"))
x1 <- new("bis620_sparse_matrix",
i = c(1, 2, 5, 6),
j = c(2, 2, 6, 1),
x = c(4.3, 5.6, 7, 10)
)
x1
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(a, b, by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c[, c("i", "j", "x")]
}
)
plus(x1, x1)
x1@i
data.frame(x1@i,x1@j,x1@x)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(data.frame(a@i,a@j,a@x), data.frame(b@i,b@j,b@x), by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c[, c("i", "j", "x")]
}
)
plus(x1, x1)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(data.frame(a@i,a@j,a@x), data.frame(b@i,b@j,b@x), by = c("x1.i", "x1.j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c[, c("i", "j", "x")]
}
)
plus(x1, x1)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
browser()
c <- merge(data.frame(a@i,a@j,a@x), data.frame(b@i,b@j,b@x), by = c("x1.i", "x1.j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x1.x)] <- 0
c$x2[is.na(c$x1)] <- 0
c$x <- c$x + c$x2
c[, c("i", "j", "x")]
}
)
plus(x1, x1)
cc
plus(x1, x1)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
browser()
c <- merge(data.frame(a@i,a@j,a@x), data.frame(b@i,b@j,b@x), by = c("x1.i", "x1.j"), all = TRUE,
suffixes = c("", "2"))
c$x1.x[is.na(c$x1.x)] <- 0
c$x1.x2[is.na(c$x1.x2)] <- 0
c$x <- c$x1.x + c$x1.x2
c[, c("x1.i", "x1.j", "x")]
}
)
plus(x1, x1)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(data.frame(a@i,a@j,a@x), data.frame(b@i,b@j,b@x), by = c("x1.i", "x1.j"), all = TRUE,
suffixes = c("", "2"))
c$x1.x[is.na(c$x1.x)] <- 0
c$x1.x2[is.na(c$x1.x2)] <- 0
c$x <- c$x1.x + c$x1.x2
c[, c("x1.i", "x1.j", "x")]
}
)
plus(x1, x1)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(data.frame(a@i,a@j,a@x), data.frame(b@i,b@j,b@x), by = c("x1.i", "x1.j"), all = TRUE,
suffixes = c("", "2"))
c$x1.x[is.na(c$x1.x)] <- 0
c$x1.x2[is.na(c$x1.x2)] <- 0
c$x1.x <- c$x1.x + c$x1.x2
c[, c("x1.i", "x1.j", "x1.x")]
}
)
plus(x1, x1)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(data.frame(i=a@i,j=a@j,x=a@x), data.frame(i=b@i,j=b@j,xb@x), by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c[, c("i", "j", "x")]
}
)
plus(x1, x1)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(data.frame(i=a@i,j=a@j,x=a@x), data.frame(i=b@i,j=b@j,x=b@x), by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c[, c("i", "j", "x")]
}
)
plus(x1, x1)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(data.frame(i=a@i,j=a@j,x=a@x), data.frame(i=b@i,j=b@j,x=b@x), by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c[, c("i", "j", "x")]
c
}
)
plus(x1, x1)
a <- plus(x1, x1)
View(a)
a
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(data.frame(i=a@i,j=a@j,x=a@x), data.frame(i=b@i,j=b@j,x=b@x), by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c<-c[, c("i", "j", "x")]
return(c)
}
)
plus(x1, x1)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(data.frame(i=a@i,j=a@j,x=a@x), data.frame(i=b@i,j=b@j,x=b@x), by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c <- c[, c("i", "j", "x")]
}
)
a <- plus(x1, x1)
a
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(data.frame(i=a@i,j=a@j,x=a@x), data.frame(i=b@i,j=b@j,x=b@x), by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c <- c[, c("i", "j", "x")]
print(c)
}
)
plus(x1, x1)
setClass(Class = "bis620_sparse_matrix",
slots = list(i = "numeric",
j = "numeric",
x = "numeric"))
my_matrix <- new("bis620_sparse_matrix", i = c(1, 2), j = c(1, 1), x = c(4.4, 1.2))
my_matrix
setGeneric(
"plus",
function(a, b){
standardGeneric("plus")
}
)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(data.frame(i=a@i,j=a@j,x=a@x), data.frame(i=b@i,j=b@j,x=b@x), by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c[, c("i", "j", "x")]
}
)
plus(x1, x1)
View(a)
rm(a)
setClass(Class = "bis620_sparse_matrix",
slots = list(i = "numeric",
j = "numeric",
x = "numeric"))
my_matrix <- new("bis620_sparse_matrix", i = c(1, 2), j = c(1, 1), x = c(4.4, 1.2))
my_matrix
setGeneric(
"plus",
function(a, b){
standardGeneric("plus")
}
)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(data.frame(i=a@i,j=a@j,x=a@x), data.frame(i=b@i,j=b@j,x=b@x), by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c[, c("i", "j", "x")]
}
)
plus(x1, x1)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(data.frame(i=a@i,j=a@j,x=a@x), data.frame(i=b@i,j=b@j,x=b@x), by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c <- c[, c("i", "j", "x")]
c
}
)
plus(x1, x1)
a <- plus(x1, x1)
a
setClass(Class = "Bus",
slots = list(n_seats = "integer",
top_speed = "numeric",
current_speed = "numeric",
brand = "character"))
setClass(Class = "SchoolBus",
slots = list(num_student_riders = "integer",
extra = "ANY"),
contains = "Bus")
my_bus <- new("Bus", n_seats = 20L, top_speed = 80L,
current_speed = 0L, brand = "Volvo")
change_speed <- function(x, new_speed) {
x@current_speed <- new_speed
x
}
change_speed(my_bus, 55)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(data.frame(i=a@i,j=a@j,x=a@x), data.frame(i=b@i,j=b@j,x=b@x), by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c <- c[, c("i", "j", "x")]
a
}
)
plus(x1, x1)
setMethod(
f = "plus",
signature = c(a = "bis620_sparse_matrix", b = "bis620_sparse_matrix"),
definition = function(a, b) {
c <- merge(data.frame(i=a@i,j=a@j,x=a@x), data.frame(i=b@i,j=b@j,x=b@x), by = c("i", "j"), all = TRUE,
suffixes = c("", "2"))
c$x[is.na(c$x)] <- 0
c$x2[is.na(c$x2)] <- 0
c$x <- c$x + c$x2
c[, c("i", "j", "x")]
}
)
a <- plus(x1, x1)
a
x <- matrix(1:12, ncol = 3)
x
x <- matrix(1:12, ncol = 3, byrow = TRUE)
x
x <- matrix(1:12, ncol = 3)
x
2 * x
2:1 * x
x
1:2 * x
1:5 * x
1:4 * x #warning
1:5 * x #warning
x * x
x * x
x %*% x
x `%*%` x
12 %% 3
12 %% 5
t(x)
t(x) %*% x
x %*% t(x)
reticulate::repl_python()
